2021-08-10 10:15:41,079 - Discovery - Open Intent Discovery Begin...
2021-08-10 10:15:41,079 - Discovery - Parameters Initialization...
2021-08-10 10:15:41,080 - Discovery - ============================== Params ==============================
2021-08-10 10:15:41,080 - Discovery - type:	open_intent_discovery
2021-08-10 10:15:41,080 - Discovery - logger_name:	Discovery
2021-08-10 10:15:41,080 - Discovery - log_dir:	logs
2021-08-10 10:15:41,080 - Discovery - dataset:	snips
2021-08-10 10:15:41,080 - Discovery - known_cls_ratio:	0.75
2021-08-10 10:15:41,080 - Discovery - labeled_ratio:	0.1
2021-08-10 10:15:41,080 - Discovery - cluster_num_factor:	1.0
2021-08-10 10:15:41,080 - Discovery - method:	CDACPlus
2021-08-10 10:15:41,080 - Discovery - train:	True
2021-08-10 10:15:41,080 - Discovery - save_model:	False
2021-08-10 10:15:41,080 - Discovery - backbone:	bert_CDAC
2021-08-10 10:15:41,080 - Discovery - setting:	semi_supervised
2021-08-10 10:15:41,080 - Discovery - config_file_name:	CDACPlus
2021-08-10 10:15:41,080 - Discovery - seed:	3
2021-08-10 10:15:41,080 - Discovery - gpu_id:	0
2021-08-10 10:15:41,080 - Discovery - pipe_results_path:	pipe_results
2021-08-10 10:15:41,080 - Discovery - data_dir:	/home/zhanghanlei/git/submit/TEXTOIR/open_intent_discovery/../data
2021-08-10 10:15:41,080 - Discovery - output_dir:	/home/sharing/disk2/zhanghanlei/save_data_162/TEXTOIR/outputs
2021-08-10 10:15:41,080 - Discovery - model_dir:	models
2021-08-10 10:15:41,080 - Discovery - result_dir:	results
2021-08-10 10:15:41,080 - Discovery - results_file_name:	results_CDACPlus.csv
2021-08-10 10:15:41,080 - Discovery - save_results:	True
2021-08-10 10:15:41,080 - Discovery - task_output_dir:	/home/sharing/disk2/zhanghanlei/save_data_162/TEXTOIR/outputs/open_intent_discovery
2021-08-10 10:15:41,080 - Discovery - method_output_dir:	/home/sharing/disk2/zhanghanlei/save_data_162/TEXTOIR/outputs/open_intent_discovery/CDACPlus_snips_0.75_0.1_bert_CDAC_3
2021-08-10 10:15:41,080 - Discovery - model_output_dir:	/home/sharing/disk2/zhanghanlei/save_data_162/TEXTOIR/outputs/open_intent_discovery/CDACPlus_snips_0.75_0.1_bert_CDAC_3/models
2021-08-10 10:15:41,080 - Discovery - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2021-08-10 10:15:41,080 - Discovery - num_labels:	None
2021-08-10 10:15:41,080 - Discovery - num_train_epochs:	46
2021-08-10 10:15:41,080 - Discovery - num_refine_epochs:	100
2021-08-10 10:15:41,080 - Discovery - max_seq_length:	None
2021-08-10 10:15:41,080 - Discovery - freeze_bert_parameters:	True
2021-08-10 10:15:41,080 - Discovery - feat_dim:	768
2021-08-10 10:15:41,080 - Discovery - warmup_proportion:	0.1
2021-08-10 10:15:41,080 - Discovery - lr:	5e-05
2021-08-10 10:15:41,080 - Discovery - activation:	tanh
2021-08-10 10:15:41,080 - Discovery - u:	0.95
2021-08-10 10:15:41,080 - Discovery - l:	0.455
2021-08-10 10:15:41,080 - Discovery - train_batch_size:	256
2021-08-10 10:15:41,080 - Discovery - eval_batch_size:	64
2021-08-10 10:15:41,080 - Discovery - test_batch_size:	64
2021-08-10 10:15:41,080 - Discovery - wait_patient:	5
2021-08-10 10:15:41,080 - Discovery - ============================== End Params ==============================
2021-08-10 10:15:41,080 - Discovery - Data and Model Preparation...
2021-08-10 10:15:41,081 - Discovery - The number of known intents is 5
2021-08-10 10:15:41,082 - Discovery - Lists of known labels are: ['RateBook', 'SearchScreeningEvent', 'SearchCreativeWork', 'PlayMusic', 'BookRestaurant']
2021-08-10 10:15:42,740 - Discovery - Number of labeled training samples = 937
2021-08-10 10:15:42,740 - Discovery - Number of unlabeled training samples = 12147
2021-08-10 10:15:42,742 - Discovery - Number of evaluation samples = 500
2021-08-10 10:15:42,743 - Discovery - Number of testing samples = 700
2021-08-10 10:15:48,808 - Discovery - Freeze all parameters but the last layer for efficiency
2021-08-10 10:16:04,726 - Discovery - Training Begin...
2021-08-10 10:16:04,726 - Discovery - Pairwise-similarity Learning begin...
2021-08-10 10:17:15,615 - Discovery - ***** Epoch: 0: Eval results *****
2021-08-10 10:17:15,615 - Discovery -   delta_label = 1.0
2021-08-10 10:17:15,615 - Discovery -   eval_score = 27.43
2021-08-10 10:17:15,615 - Discovery -   l_threshold = 0.455
2021-08-10 10:17:15,615 - Discovery -   train_labeled_loss = 4.9324257373809814
2021-08-10 10:17:15,615 - Discovery -   train_loss = 0.6565365264048943
2021-08-10 10:17:15,615 - Discovery -   u_threshold = 0.95
2021-08-10 10:18:23,396 - Discovery - ***** Epoch: 1: Eval results *****
2021-08-10 10:18:23,396 - Discovery -   delta_label = 0.414
2021-08-10 10:18:23,396 - Discovery -   eval_score = 43.05
2021-08-10 10:18:23,396 - Discovery -   l_threshold = 0.456
2021-08-10 10:18:23,396 - Discovery -   train_labeled_loss = 5.819273829460144
2021-08-10 10:18:23,396 - Discovery -   train_loss = 0.5939207512598771
2021-08-10 10:18:23,396 - Discovery -   u_threshold = 0.9401
2021-08-10 10:19:31,182 - Discovery - ***** Epoch: 2: Eval results *****
2021-08-10 10:19:31,182 - Discovery -   delta_label = 0.384
2021-08-10 10:19:31,182 - Discovery -   eval_score = 64.81
2021-08-10 10:19:31,182 - Discovery -   l_threshold = 0.457
2021-08-10 10:19:31,182 - Discovery -   train_labeled_loss = 2.819349229335785
2021-08-10 10:19:31,182 - Discovery -   train_loss = 0.5453618615865707
2021-08-10 10:19:31,182 - Discovery -   u_threshold = 0.9302
2021-08-10 10:20:38,841 - Discovery - ***** Epoch: 3: Eval results *****
2021-08-10 10:20:38,841 - Discovery -   delta_label = 0.18
2021-08-10 10:20:38,841 - Discovery -   eval_score = 73.35
2021-08-10 10:20:38,841 - Discovery -   l_threshold = 0.458
2021-08-10 10:20:38,842 - Discovery -   train_labeled_loss = 1.8276652097702026
2021-08-10 10:20:38,842 - Discovery -   train_loss = 0.512165391101287
2021-08-10 10:20:38,842 - Discovery -   u_threshold = 0.9203
2021-08-10 10:21:46,502 - Discovery - ***** Epoch: 4: Eval results *****
2021-08-10 10:21:46,503 - Discovery -   delta_label = 0.07
2021-08-10 10:21:46,503 - Discovery -   eval_score = 78.21
2021-08-10 10:21:46,503 - Discovery -   l_threshold = 0.459
2021-08-10 10:21:46,503 - Discovery -   train_labeled_loss = 0.8934962153434753
2021-08-10 10:21:46,503 - Discovery -   train_loss = 0.48517580788869125
2021-08-10 10:21:46,503 - Discovery -   u_threshold = 0.9104
2021-08-10 10:22:54,132 - Discovery - ***** Epoch: 5: Eval results *****
2021-08-10 10:22:54,132 - Discovery -   delta_label = 0.088
2021-08-10 10:22:54,132 - Discovery -   eval_score = 76.25
2021-08-10 10:22:54,132 - Discovery -   l_threshold = 0.46
2021-08-10 10:22:54,132 - Discovery -   train_labeled_loss = 0.5238015353679657
2021-08-10 10:22:54,132 - Discovery -   train_loss = 0.4677577901345033
2021-08-10 10:22:54,132 - Discovery -   u_threshold = 0.9005
2021-08-10 10:24:01,716 - Discovery - ***** Epoch: 6: Eval results *****
2021-08-10 10:24:01,716 - Discovery -   delta_label = 0.074
2021-08-10 10:24:01,716 - Discovery -   eval_score = 78.08
2021-08-10 10:24:01,716 - Discovery -   l_threshold = 0.4609
2021-08-10 10:24:01,716 - Discovery -   train_labeled_loss = 0.38701701164245605
2021-08-10 10:24:01,716 - Discovery -   train_loss = 0.4514373678427476
2021-08-10 10:24:01,716 - Discovery -   u_threshold = 0.8906
2021-08-10 10:25:09,370 - Discovery - ***** Epoch: 7: Eval results *****
2021-08-10 10:25:09,370 - Discovery -   delta_label = 0.048
2021-08-10 10:25:09,370 - Discovery -   eval_score = 78.71
2021-08-10 10:25:09,370 - Discovery -   l_threshold = 0.4619
2021-08-10 10:25:09,370 - Discovery -   train_labeled_loss = 0.4399254843592644
2021-08-10 10:25:09,370 - Discovery -   train_loss = 0.43637657165527344
2021-08-10 10:25:09,370 - Discovery -   u_threshold = 0.8807
2021-08-10 10:26:17,101 - Discovery - ***** Epoch: 8: Eval results *****
2021-08-10 10:26:17,102 - Discovery -   delta_label = 0.032
2021-08-10 10:26:17,102 - Discovery -   eval_score = 77.49
2021-08-10 10:26:17,102 - Discovery -   l_threshold = 0.4629
2021-08-10 10:26:17,102 - Discovery -   train_labeled_loss = 0.19278454594314098
2021-08-10 10:26:17,102 - Discovery -   train_loss = 0.4225718080997467
2021-08-10 10:26:17,102 - Discovery -   u_threshold = 0.8708
2021-08-10 10:27:24,749 - Discovery - ***** Epoch: 9: Eval results *****
2021-08-10 10:27:24,749 - Discovery -   delta_label = 0.038
2021-08-10 10:27:24,749 - Discovery -   eval_score = 77.64
2021-08-10 10:27:24,749 - Discovery -   l_threshold = 0.4639
2021-08-10 10:27:24,749 - Discovery -   train_labeled_loss = 0.12455535121262074
2021-08-10 10:27:24,749 - Discovery -   train_loss = 0.40915784812890565
2021-08-10 10:27:24,749 - Discovery -   u_threshold = 0.8609
2021-08-10 10:28:32,406 - Discovery - ***** Epoch: 10: Eval results *****
2021-08-10 10:28:32,406 - Discovery -   delta_label = 0.028
2021-08-10 10:28:32,406 - Discovery -   eval_score = 77.35
2021-08-10 10:28:32,406 - Discovery -   l_threshold = 0.4649
2021-08-10 10:28:32,406 - Discovery -   train_labeled_loss = 0.08194278925657272
2021-08-10 10:28:32,406 - Discovery -   train_loss = 0.3969469769642903
2021-08-10 10:28:32,406 - Discovery -   u_threshold = 0.851
2021-08-10 10:29:40,056 - Discovery - ***** Epoch: 11: Eval results *****
2021-08-10 10:29:40,056 - Discovery -   delta_label = 0.032
2021-08-10 10:29:40,056 - Discovery -   eval_score = 79.12
2021-08-10 10:29:40,056 - Discovery -   l_threshold = 0.4659
2021-08-10 10:29:40,057 - Discovery -   train_labeled_loss = 0.08304262161254883
2021-08-10 10:29:40,057 - Discovery -   train_loss = 0.3850576992218311
2021-08-10 10:29:40,057 - Discovery -   u_threshold = 0.8411
2021-08-10 10:30:47,643 - Discovery - ***** Epoch: 12: Eval results *****
2021-08-10 10:30:47,643 - Discovery -   delta_label = 0.034
2021-08-10 10:30:47,643 - Discovery -   eval_score = 80.01
2021-08-10 10:30:47,643 - Discovery -   l_threshold = 0.4669
2021-08-10 10:30:47,643 - Discovery -   train_labeled_loss = 0.054085914976894855
2021-08-10 10:30:47,643 - Discovery -   train_loss = 0.3731441188317079
2021-08-10 10:30:47,643 - Discovery -   u_threshold = 0.8312
2021-08-10 10:31:55,283 - Discovery - ***** Epoch: 13: Eval results *****
2021-08-10 10:31:55,283 - Discovery -   delta_label = 0.03
2021-08-10 10:31:55,283 - Discovery -   eval_score = 79.7
2021-08-10 10:31:55,283 - Discovery -   l_threshold = 0.4679
2021-08-10 10:31:55,283 - Discovery -   train_labeled_loss = 0.050834876485168934
2021-08-10 10:31:55,283 - Discovery -   train_loss = 0.3624404611495825
2021-08-10 10:31:55,283 - Discovery -   u_threshold = 0.8213
2021-08-10 10:33:02,066 - Discovery - ***** Epoch: 14: Eval results *****
2021-08-10 10:33:02,066 - Discovery -   delta_label = 0.028
2021-08-10 10:33:02,066 - Discovery -   eval_score = 80.38
2021-08-10 10:33:02,066 - Discovery -   l_threshold = 0.4689
2021-08-10 10:33:02,066 - Discovery -   train_labeled_loss = 0.06056295242160559
2021-08-10 10:33:02,066 - Discovery -   train_loss = 0.3502751611746274
2021-08-10 10:33:02,066 - Discovery -   u_threshold = 0.8114
2021-08-10 10:34:09,151 - Discovery - ***** Epoch: 15: Eval results *****
2021-08-10 10:34:09,152 - Discovery -   delta_label = 0.022
2021-08-10 10:34:09,152 - Discovery -   eval_score = 79.46
2021-08-10 10:34:09,152 - Discovery -   l_threshold = 0.4698
2021-08-10 10:34:09,152 - Discovery -   train_labeled_loss = 0.04286218620836735
2021-08-10 10:34:09,152 - Discovery -   train_loss = 0.3388179185298773
2021-08-10 10:34:09,152 - Discovery -   u_threshold = 0.8015
2021-08-10 10:35:16,761 - Discovery - ***** Epoch: 16: Eval results *****
2021-08-10 10:35:16,761 - Discovery -   delta_label = 0.008
2021-08-10 10:35:16,762 - Discovery -   eval_score = 79.69
2021-08-10 10:35:16,762 - Discovery -   l_threshold = 0.4708
2021-08-10 10:35:16,762 - Discovery -   train_labeled_loss = 0.028911452274769545
2021-08-10 10:35:16,762 - Discovery -   train_loss = 0.3276722259246386
2021-08-10 10:35:16,762 - Discovery -   u_threshold = 0.7916
2021-08-10 10:36:24,388 - Discovery - ***** Epoch: 17: Eval results *****
2021-08-10 10:36:24,388 - Discovery -   delta_label = 0.008
2021-08-10 10:36:24,388 - Discovery -   eval_score = 79.78
2021-08-10 10:36:24,389 - Discovery -   l_threshold = 0.4718
2021-08-10 10:36:24,389 - Discovery -   train_labeled_loss = 0.0343440780416131
2021-08-10 10:36:24,389 - Discovery -   train_loss = 0.3160749203883685
2021-08-10 10:36:24,389 - Discovery -   u_threshold = 0.7817
2021-08-10 10:37:37,333 - Discovery - ***** Epoch: 18: Eval results *****
2021-08-10 10:37:37,333 - Discovery -   delta_label = 0.016
2021-08-10 10:37:37,333 - Discovery -   eval_score = 80.01
2021-08-10 10:37:37,333 - Discovery -   l_threshold = 0.4728
2021-08-10 10:37:37,333 - Discovery -   train_labeled_loss = 0.020347165409475565
2021-08-10 10:37:37,333 - Discovery -   train_loss = 0.3049459079137215
2021-08-10 10:37:37,334 - Discovery -   u_threshold = 0.7718
2021-08-10 10:38:52,013 - Discovery - ***** Epoch: 19: Eval results *****
2021-08-10 10:38:52,013 - Discovery -   delta_label = 0.012
2021-08-10 10:38:52,014 - Discovery -   eval_score = 79.95
2021-08-10 10:38:52,014 - Discovery -   l_threshold = 0.4738
2021-08-10 10:38:52,014 - Discovery -   train_labeled_loss = 0.022888656705617905
2021-08-10 10:38:52,014 - Discovery -   train_loss = 0.2936583917874556
2021-08-10 10:38:52,014 - Discovery -   u_threshold = 0.7619
2021-08-10 10:40:06,658 - Discovery - ***** Epoch: 20: Eval results *****
2021-08-10 10:40:06,658 - Discovery -   delta_label = 0.02
2021-08-10 10:40:06,658 - Discovery -   eval_score = 79.73
2021-08-10 10:40:06,658 - Discovery -   l_threshold = 0.4748
2021-08-10 10:40:06,658 - Discovery -   train_labeled_loss = 0.01990100648254156
2021-08-10 10:40:06,658 - Discovery -   train_loss = 0.2824831089148155
2021-08-10 10:40:06,658 - Discovery -   u_threshold = 0.752
